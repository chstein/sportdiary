(function(n){typeof define=="function"&&define.amd?define(["knockout","jquery","jquery.ui.sortable"],n):n(window.ko,jQuery)})(function(n,t,i){var o="ko_sortItem",h="ko_sourceIndex",s="ko_sortList",c="ko_parentList",l="ko_dragItem",r=n.utils.unwrapObservable,u=n.utils.domData.get,f=n.utils.domData.set,a=function(t,i){n.utils.arrayForEach(t,function(n){n.nodeType===1&&(f(n,o,i),f(n,c,u(n.parentNode,s)))})},e=function(t,i){var u={},f=r(t()),e;return f.data?(u[i]=f.data,u.name=f.template):u[i]=t(),n.utils.arrayForEach(["afterAdd","afterRender","as","beforeRemove","includeDestroyed","templateEngine","templateOptions"],function(t){u[t]=f[t]||n.bindingHandlers.sortable[t]}),i==="foreach"&&(u.afterRender?(e=u.afterRender,u.afterRender=function(n,t){a.call(t,n,t),e.call(t,n,t)}):u.afterRender=a),u},v=function(n,t){var u=r(t),i;if(u)for(i=0;i<n;i++)u[i]&&r(u[i]._destroy)&&n++;return n};n.bindingHandlers.sortable={init:function(a,y,p,w,b){var d=t(a),g=r(y())||{},nt=e(y,"foreach"),k={},tt,it,rt;return n.utils.arrayForEach(a.childNodes,function(n){n&&n.nodeType===3&&n.parentNode.removeChild(n)}),t.extend(!0,k,n.bindingHandlers.sortable),g.options&&k.options&&(n.utils.extend(k.options,g.options),delete g.options),n.utils.extend(k,g),k.connectClass&&(n.isObservable(k.allowDrop)||typeof k.allowDrop=="function")?n.computed({read:function(){var t=r(k.allowDrop),i=typeof t=="function"?t.call(this,nt.foreach):t;n.utils.toggleDomNodeCssClass(a,k.connectClass,i)},disposeWhenNodeIsRemoved:a},this):n.utils.toggleDomNodeCssClass(a,k.connectClass,k.allowDrop),n.bindingHandlers.template.init(a,function(){return nt},p,w,b),tt=k.options.start,it=k.options.update,rt=setTimeout(function(){var e;d.sortable(n.utils.extend(k.options,{start:function(t,i){var r=i.item[0];f(r,h,n.utils.arrayIndexOf(i.item.parent().children(),r)),i.item.find("input:focus").change(),tt&&tt.apply(this,arguments)},receive:function(n,t){e=u(t.item[0],l),e&&(e.clone&&(e=e.clone()),k.dragged&&(e=k.dragged.call(this,e,n,t)||e))},update:function(i,r){var y,b,w,p,a,l=r.item[0],g=r.item.parent()[0],d=u(l,o)||e;if(e=null,d&&(this===g||t.contains(this,g))){if(y=u(l,c),w=u(l,h),b=u(l.parentNode,s),p=n.utils.arrayIndexOf(r.item.parent().children(),l),nt.includeDestroyed||(w=v(w,y),p=v(p,b)),(k.beforeMove||k.afterMove)&&(a={item:d,sourceParent:y,sourceParentNode:y&&r.sender||l.parentNode,sourceIndex:w,targetParent:b,targetIndex:p,cancelDrop:!1}),k.beforeMove&&(k.beforeMove.call(this,a,i,r),a.cancelDrop)){a.sourceParent?t(a.sourceParent===a.targetParent?this:r.sender).sortable("cancel"):t(l).remove();return}p>=0&&(y&&(y.splice(w,1),n.processAllDeferredBindingUpdates&&n.processAllDeferredBindingUpdates()),b.splice(p,0,d)),f(l,o,null),r.item.remove(),n.processAllDeferredBindingUpdates&&n.processAllDeferredBindingUpdates(),k.afterMove&&k.afterMove.call(this,a,i,r)}it&&it.apply(this,arguments)},connectWith:k.connectClass?"."+k.connectClass:!1})),k.isEnabled!==i&&n.computed({read:function(){d.sortable(r(k.isEnabled)?"enable":"disable")},disposeWhenNodeIsRemoved:a})},0),n.utils.domNodeDisposal.addDisposeCallback(a,function(){d.data("sortable")&&d.sortable("destroy"),clearTimeout(rt)}),{controlsDescendantBindings:!0}},update:function(t,i,r,u,o){var h=e(i,"foreach");f(t,s,h.foreach),n.bindingHandlers.template.update(t,function(){return h},r,u,o)},connectClass:"ko_container",allowDrop:!0,afterMove:null,beforeMove:null,options:{}},n.bindingHandlers.draggable={init:function(u,o,s,h,c){var a=r(o())||{},w=a.options||{},v=n.utils.extend({},n.bindingHandlers.draggable.options),b=e(o,"data"),y=a.connectClass||n.bindingHandlers.draggable.connectClass,p=a.isEnabled!==i?a.isEnabled:n.bindingHandlers.draggable.isEnabled;return a=a.data||a,f(u,l,a),n.utils.extend(v,w),v.connectToSortable=y?"."+y:!1,t(u).draggable(v),p!==i&&n.computed({read:function(){t(u).draggable(r(p)?"enable":"disable")},disposeWhenNodeIsRemoved:u}),n.bindingHandlers.template.init(u,function(){return b},s,h,c)},update:function(t,i,r,u,f){var o=e(i,"data");return n.bindingHandlers.template.update(t,function(){return o},r,u,f)},connectClass:n.bindingHandlers.sortable.connectClass,options:{helper:"clone"}}});
//@ sourceMappingURL=knockout-sortable.min.js.map