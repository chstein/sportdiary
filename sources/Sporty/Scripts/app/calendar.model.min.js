(function(n,t){function i(t){var i=this;t=t||{},i.isFavorite=n.observable(!1),i.sessionId=n.observable(t.sessionId),i.sportTypeName=n.observable(t.sportTypeName),i.sportTypeId=n.observable(t.sportTypeId),i.duration=n.observable(t.duration),i.durationWithUnit=n.computed(function(){return i.duration()?i.duration()+" '":""}),i.plannedDuration=n.observable(t.plannedDuration),i.distance=n.observable(t.distance),i.distanceWithUnit=n.computed(function(){return i.distance()?i.distance()+" km":""}),i.plannedDistance=n.observable(t.plannedDistance),i.zoneId=n.observable(t.zoneId),i.zoneName=n.observable(t.zoneName),i.heartrate=n.observable(t.heartrate),i.heartrateWithUnit=n.computed(function(){return i.heartrate()?i.heartrate()+" bpm":""}),i.isFavorite=n.observable(t.isFavorite),i.discipline=n.observable(t.discipline),i.showMenu=n.observable(!1),i.showItemMenu=function(){i.showMenu(!0)},i.hideItemMenu=function(){i.showMenu(!1)},i.toJson=function(){return n.toJSON(i)}}function u(r,u,f,e){var o=this;r=r||{},o.currentDay=r.day,o.clientId=r.clientId,o.goalName=n.observable(r.goalName),o.isDayInMonth=n.observable(r.isDayInMonth),o.isGoalToday=n.observable(r.isGoalToday),o.isDayToday=n.observable(r.isDayToday),o.sessions=n.observableArray(new h(r.sessions)),o.sessions.parentId=o.clientId,o.sessions.weekNumber=u,o.showMenu=n.observable(!1),o.showAddMenu=function(){o.showMenu(!0)},o.hideAddMenu=function(){o.showMenu(!1)},o.createNewSesssionLink=n.computed(function(){return"/"+calendarMode+"/create?defaultDate="+o.clientId}),o.deleteSession=function(n,i){var r=$(i.target).attr("title");bootbox.confirm(r,function(i){i&&(f(n),o.sessions.remove(n),t.removeSession(n.sessionId()))})},o.copySession=function(r){var u=new i(n.toJS(r));e(r),o.sessions.push(u),t.updateSessionDate(o.clientId,u.sessionId(),!0,function(n){u.sessionId(n)})},o.toJson=function(){return n.toJSON(o)}}function r(t,i){var r=this;r.weekNumber=i,r.discipline=t.discipline,r.sportTypeId=n.observable(t.sportTypeId),r.duration=n.observable(t.duration),r.plannedDuration=n.observable(t.plannedDuration),r.distance=n.observable(t.distance),r.plannedDistance=n.observable(t.plannedDistance),r.durationInTime=n.computed(function(){return r.duration()>0&&r.duration()!=undefined?secondsToHms(r.duration()):" - "}),r.plannedDurationInTime=n.computed(function(){return r.plannedDuration()>0&&r.plannedDuration()!=undefined?secondsToHms(r.plannedDuration()):" - "})}function f(t){var i=this;t=t||{},i.isFavorite=n.observable(!0),i.sessionId=n.observable(t.id),i.sportTypeName=n.observable(t.sportTypeName),i.sportTypeId=n.observable(t.sportTypeId),i.description=n.observable(t.description),i.duration=n.observable(t.duration),i.plannedDuration=n.observable(t.plannedDuration),i.plannedDurationWithUnit=n.computed(function(){return i.plannedDuration()?i.plannedDuration()+" '":""}),i.distance=n.observable(t.distance),i.distanceWithUnit=n.computed(function(){return i.distance()?i.distance()+" km":""}),i.heartrate=n.observable(t.heartrate),i.heartrateWithUnit=n.computed(function(){return i.heartrate()?i.heartrate()+" bpm":""}),i.plannedDistance=n.observable(t.plannedDistance),i.zoneId=n.observable(t.zoneId),i.zoneName=n.observable(t.zoneName),i.discipline=n.observable(t.discipline),i.showMenu=n.observable(!1),i.showItemMenu=function(){i.showMenu(!0)},i.hideItemMenu=function(){i.showMenu(!1)},i.toJson=function(){return n.toJSON(i)}}function e(u){function h(n){for(var i,r,t=0;t<f.weekSummary().length;t++)n.sportTypeId()===f.weekSummary()[t].sportTypeId()&&(i=f.weekSummary()[t].duration()-n.duration(),(i==NaN||i<0)&&(i=0),f.weekSummary()[t].duration(i),r=f.weekSummary()[t].plannedDuration()-n.plannedDuration(),(r==NaN||r<0)&&(r=0),f.weekSummary()[t].plannedDuration(r),f.weekSummary()[t].duration()==0&&f.weekSummary()[t].plannedDuration()==0&&f.weekSummary.remove(f.weekSummary()[t]))}function e(n){for(var i=!1,u,e,t=0;t<f.weekSummary().length;t++)n.sportTypeId()===f.weekSummary()[t].sportTypeId()&&(i=!0,n.duration()&&f.weekSummary()[t].duration(f.weekSummary()[t].duration()+n.duration()),n.plannedDuration()&&f.weekSummary()[t].plannedDuration(f.weekSummary()[t].plannedDuration()+n.plannedDuration()));i||(u={discipline:n.discipline(),sportTypeId:n.sportTypeId(),duration:n.duration(),plannedDuration:n.plannedDuration(),distance:0,plannedDistance:0},e=new r(u,f.number()),f.weekSummary.push(e))}var f=this;u=u||{},f.number=n.observable(u.number),f.firstDayInWeek=n.observable(u.firstDayInWeek),f.phase=n.observable(u.phase),f.weekNumberToNextGoal=n.observable(u.weekNumberToNextGoal),f.weekSummary=n.observableArray(new o(u.weekSummary,f.number())),f.weekSummary.removeSession=function(n){h(n)},f.weekSummary.addSession=function(n){e(n)},f.afterDrag=function(t){return new i(n.toJS(t))},f.updateSession=function(n){var r,i;if(n.item.isFavorite())e(n.item),n.item.isFavorite(!1),n.item.duration(n.item.plannedDuration()),t.updateSessionDate(n.targetParent.parentId,n.item.sessionId(),!0,function(t){n.item.sessionId(t)});else{r=n.sourceParent.weekNumber,i=n.item;var u=n.targetParent.weekNumber,f=n.targetParent.parentId,o=n.item.sessionId();i.isFavorite(!1),t.updateSessionWeek(i,f,o,r,u)}},f.days=n.observableArray(new s(u.days,f.number(),f.weekSummary.removeSession,f.weekSummary.addSession)),f.allDurationInTime=n.computed(function(){for(var t=0,n=0;n<f.weekSummary().length;n++)t+=f.weekSummary()[n].duration();return t<=0?" - ":secondsToHms(t)}),f.allPlannedDurationInTime=n.computed(function(){for(var t=0,n=0;n<f.weekSummary().length;n++)t+=f.weekSummary()[n].plannedDuration();return t<=0?" - ":secondsToHms(t)}),f.toJson=function(){return n.toJSON(f)}}function o(n,t){return $.map(n||[],function(n){return new r(n,t)})}function s(n,t,i,r){return $.map(n||[],function(n){return new u(n,t,i,r)})}function h(n){return $.map(n||[],function(n){return new i(n)})}t.week=e,t.favorite=f})(ko,entitiesApp.datacontext);
//@ sourceMappingURL=calendar.model.min.js.map